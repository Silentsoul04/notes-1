<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>胖大人的日常记事</title>
    <meta name="description" content="Just playing around">
    <link rel="icon" href="/logo.ico">
  <link rel="manifest" href="/manifest.json">
    
    <link rel="preload" href="/assets/css/0.styles.d6cdabc1.css" as="style"><link rel="preload" href="/assets/js/app.92625234.js" as="script"><link rel="preload" href="/assets/js/2.38d85b4c.js" as="script"><link rel="preload" href="/assets/js/9.d271e8c5.js" as="script"><link rel="prefetch" href="/assets/js/10.1a50f243.js"><link rel="prefetch" href="/assets/js/11.bad254af.js"><link rel="prefetch" href="/assets/js/12.56baed48.js"><link rel="prefetch" href="/assets/js/13.7055bfb2.js"><link rel="prefetch" href="/assets/js/14.eb7e1e0e.js"><link rel="prefetch" href="/assets/js/15.20ae4527.js"><link rel="prefetch" href="/assets/js/16.53f5f52a.js"><link rel="prefetch" href="/assets/js/17.559421a0.js"><link rel="prefetch" href="/assets/js/18.2a06a394.js"><link rel="prefetch" href="/assets/js/19.42604d4f.js"><link rel="prefetch" href="/assets/js/20.52090e26.js"><link rel="prefetch" href="/assets/js/21.dd9ac026.js"><link rel="prefetch" href="/assets/js/22.21f5f57a.js"><link rel="prefetch" href="/assets/js/23.b2f0989f.js"><link rel="prefetch" href="/assets/js/24.ec557b6b.js"><link rel="prefetch" href="/assets/js/25.6644ec66.js"><link rel="prefetch" href="/assets/js/26.60483ab2.js"><link rel="prefetch" href="/assets/js/27.3798eaab.js"><link rel="prefetch" href="/assets/js/28.8d842cc3.js"><link rel="prefetch" href="/assets/js/29.7c4d8f6b.js"><link rel="prefetch" href="/assets/js/3.a2e674c2.js"><link rel="prefetch" href="/assets/js/30.b105f212.js"><link rel="prefetch" href="/assets/js/31.01c7643e.js"><link rel="prefetch" href="/assets/js/32.45e721ae.js"><link rel="prefetch" href="/assets/js/33.567b3ff4.js"><link rel="prefetch" href="/assets/js/34.d9579cd9.js"><link rel="prefetch" href="/assets/js/35.3a605990.js"><link rel="prefetch" href="/assets/js/36.7321ee72.js"><link rel="prefetch" href="/assets/js/37.663a1ee1.js"><link rel="prefetch" href="/assets/js/4.6352c09c.js"><link rel="prefetch" href="/assets/js/5.ae17a9ef.js"><link rel="prefetch" href="/assets/js/6.c1d31416.js"><link rel="prefetch" href="/assets/js/7.a0ef9559.js"><link rel="prefetch" href="/assets/js/8.817ff80f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d6cdabc1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">胖大人的日常记事</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/0001.html" class="sidebar-link">01 开篇词 | 使用 Webpack 实现前端工程化</a></li><li><a href="/0002.html" class="sidebar-link">02 什么是 Webpack</a></li><li><a href="/0003.html" class="sidebar-link">03 Webpack 开发环境搭建</a></li><li><a href="/0004.html" class="active sidebar-link">04 使用 webpack-cli 体验零配置打包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/0004.html#初始化项目" class="sidebar-link">初始化项目</a></li><li class="sidebar-sub-header"><a href="/0004.html#创建目录" class="sidebar-link">创建目录</a></li><li class="sidebar-sub-header"><a href="/0004.html#npm-scripts" class="sidebar-link">npm scripts</a></li><li class="sidebar-sub-header"><a href="/0004.html#修改打包输出目录" class="sidebar-link">修改打包输出目录</a></li><li class="sidebar-sub-header"><a href="/0004.html#使用-loader-来做-es6-语法转换" class="sidebar-link">使用 Loader 来做 ES6 语法转换</a></li><li class="sidebar-sub-header"><a href="/0004.html#通过-babel-来转换-es6-语法" class="sidebar-link">通过 Babel 来转换 ES6 语法</a></li><li class="sidebar-sub-header"><a href="/0004.html#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/0005.html" class="sidebar-link">05 基础概念和常见配置项介绍（一）</a></li><li><a href="/0006.html" class="sidebar-link">06 基础概念和常见配置项介绍（二）</a></li><li><a href="/0007.html" class="sidebar-link">07 Webpack 中的模块化开发</a></li><li><a href="/0008.html" class="sidebar-link">08 在 Webpack 中使用 Babel 转换 JavaScript 代码</a></li><li><a href="/0009.html" class="sidebar-link">09 Webpack 中使用 TypeScript 开发项目</a></li><li><a href="/0010.html" class="sidebar-link">10 Webpack 中样式相关的配置</a></li><li><a href="/0011.html" class="sidebar-link">11 Webpack 中使用 lint 工具来保证代码风格和质量</a></li><li><a href="/0012.html" class="sidebar-link">12 使用 Webpack 管理项目中的静态资源</a></li><li><a href="/0013.html" class="sidebar-link">13 Webpack 中打包 HTML 和多页面配置</a></li><li><a href="/0014.html" class="sidebar-link">14 Webpack Dev Server 本地开发服务</a></li><li><a href="/0015.html" class="sidebar-link">15 Webpack 中配置React和Vue开发环境</a></li><li><a href="/0016.html" class="sidebar-link">16 Webpack 环境相关配置及配置文件拆分</a></li><li><a href="/0017.html" class="sidebar-link">17 Webpack 优化之体积优化</a></li><li><a href="/0018.html" class="sidebar-link">18 Webpack 优化之增强缓存命中率</a></li><li><a href="/0019.html" class="sidebar-link">19 使用 Webpack 的 splitChunks 功能来拆分代码</a></li><li><a href="/0020.html" class="sidebar-link">20 Webpack 优化之速度优化</a></li><li><a href="/0021.html" class="sidebar-link">21 使用 Webpack 的 Tree-Shaking</a></li><li><a href="/0022.html" class="sidebar-link">22 为你准备了一份 Webpack 工程化最佳实践总结</a></li><li><a href="/0023.html" class="sidebar-link">23 怎么调试 Webpack？</a></li><li><a href="/0024.html" class="sidebar-link">24 Tapable —— Webpack 的核心模块</a></li><li><a href="/0025.html" class="sidebar-link">25 Webpack 的 Compiler 和 Compilation</a></li><li><a href="/0026.html" class="sidebar-link">26 Webpack 工作流程</a></li><li><a href="/0027.html" class="sidebar-link">27 从 Webpack 的产出代码来看 Webpack 是怎么执行的</a></li><li><a href="/0028.html" class="sidebar-link">28 Webpack 的模块热替换做了什么？</a></li><li><a href="/0029.html" class="sidebar-link">29 实战：使用 PostCSS 打造移动适配方案</a></li><li><a href="/0030.html" class="sidebar-link">30 实战：手写一个 markdown-loader</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><img src="https://img4.mukewang.com/5cd962f40001a7a706400360.jpg" alt=""></p> <blockquote><p>人生太短，要干的事太多，我要争分夺秒。</p> <p>               ——爱迪生</p></blockquote> <p>下面通过搭建一个使用 Webpack 打包的项目，来体验下 Webpack 的零配置打包。</p> <h2 id="初始化项目"><a href="#初始化项目" aria-hidden="true" class="header-anchor">#</a> 初始化项目</h2> <p>首先是创建项目，创建一个名字为zero-config的文件夹，并且进入文件夹使用npm init进行初始化：</p> <div class="language- extra-class"><pre class="language-text"><code># 创建目录并且进入
mkdir zero-config &amp;&amp; cd $_
# 初始化
npm init -y
# 安装 webpack 和 webpack-cli到开发依赖
npm i webpack --save-dev
npm i webpack-cli --save-dev
</code></pre></div><h2 id="创建目录"><a href="#创建目录" aria-hidden="true" class="header-anchor">#</a> 创建目录</h2> <p>新建src目录，放置我们的源码，目录结构如下：</p> <div class="language- extra-class"><pre class="language-text"><code>└── src
    ├── hello.js
    ├── index.js
    └── world.js
</code></pre></div><p>hello.js、 world.js和index.js三个文件内容如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// hello</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token comment">// world</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token string">'world'</span><span class="token punctuation">;</span>
<span class="token comment">// index</span>
<span class="token keyword">const</span> hello <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> world <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hello<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>world<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这时候我们使用 webpack命令（如果全局安装 webpack-cli 包的话）可以直接体验 Webpack 打包效果。</p> <blockquote><p><em><strong>TIPS:</strong></em> <a href="https://www.npmjs.com/package/npx" target="_blank" rel="noopener noreferrer">npx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一个方便开发者访问 node_modules 内的 bin 命令行的小工具，npx webpack -v 相当于执行了 node ./node_modules/webpack/bin/webpack -v ，npx 在开发中非常方便，推荐安装：npm install -g npx 。</p></blockquote> <h2 id="npm-scripts"><a href="#npm-scripts" aria-hidden="true" class="header-anchor">#</a> npm scripts</h2> <p>下面，我们打开package.json文件，然后添加scripts字段：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加完保存后，在项目目录下执行npm run build，看到如下执行结果：</p> <p><img src="http://img.mukewang.com/5cd8d3f50001297014441032.png" alt=""></p> <p>执行成功，index.js 文件被打包到了dist文件夹下了，同时提示我们默认使用了production mode，即生产环境，打开dist/main.js，里面的代码的确是被压缩的，说明是生产环境打包；下面继续修改package.json添加scripts：</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;dev&quot;: &quot;webpack --mode development&quot;,
  &quot;build&quot;: &quot;webpack --mode production&quot;
}
</code></pre></div><p>这时候在执行npm run dev，结果如下：
<img src="http://img.mukewang.com/5cd8d4240001846f14440648.png" alt=""></p> <p>嗯，这次没有压缩，而且也不报 warning 了！</p> <blockquote><p><em><strong>Tips:</strong></em> Webpack 的打包环境有 production 和 development 两种，分别对应生产环境和开发环境，生产环境默认配置包括压缩等常用的配置。</p></blockquote> <h2 id="修改打包输出目录"><a href="#修改打包输出目录" aria-hidden="true" class="header-anchor">#</a> 修改打包输出目录</h2> <p>通过上面的演示，我们得到下面的结论：</p> <ol><li>Webpack 默认的入口文件是src/index.js；</li> <li>Webpack 的默认输出目录是dist/main.js。
我们如果要修改 Webpack 的默认输出目录，需要用到 Webpack 命令的--output，我们将上面的 npm scripts 做下修改：</li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode development --output ./output/main.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode production --output ./output/main.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候在执行npm run build，则 webpack 会将打包之后的文件输出到output/main.js路径了：</p> <p><img src="http://img.mukewang.com/5cd8d60900015b7016860744.png" alt=""></p> <h2 id="使用-loader-来做-es6-语法转换"><a href="#使用-loader-来做-es6-语法转换" aria-hidden="true" class="header-anchor">#</a> 使用 Loader 来做 ES6 语法转换</h2> <p>现在，我们将之前的代码用的是 ES6 的 Module 语法进行重写，这在普通的浏览器执行起来可能会因为语法「太先进」而报错，所以我们需要使用 Babel 来对 ES6 语法的代码进行转换。</p> <p>在 src 下新建一个 es 的文件夹，将 ES6 语法的代码放进去。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// hello.es.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>

<span class="token comment">// world.es.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token string">'world'</span><span class="token punctuation">;</span>
<span class="token comment">// index.es.js</span>
<span class="token keyword">import</span> hello <span class="token keyword">from</span> <span class="token string">'./hello'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> world <span class="token keyword">from</span> <span class="token string">'./world'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hello<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>world<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这是需要修改下package.json的 scripts 字段，将默认打包的入口文件（src/index.js）修改为src/es/index.js地址：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode development ./src/es/index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode production ./src/es/index.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时候执行npm run dev的打包出来的是 ES6 语法的代码，在一些老点的浏览器或者移动终端浏览器中都会报错，这时候就需要 Babel 来转换 ES6 语法了。</p> <h2 id="通过-babel-来转换-es6-语法"><a href="#通过-babel-来转换-es6-语法" aria-hidden="true" class="header-anchor">#</a> 通过 Babel 来转换 ES6 语法</h2> <p>Babel 是 JavaScript 的一个编译器，能够将 ES6+ 语法转换为 ES5 语法，保证浏览器的兼容性，后面的章节还会继续介绍 Babel 的用法，这里为了快速入门 webpack 所以从简介绍。</p> <p>Loader 是 Webpack 中的一个重要概念，通过 Loader 我们可以做一些跟文件自身属性相关的一些操作，比如这里做的 ES6 语法转换，用到的是babel-loader，这个 Loader 依赖@babel/core和@babel/preset-env。</p> <p>所以首先安装它们：</p> <div class="language- extra-class"><pre class="language-text"><code>npm i @babel/core babel-loader @babel/preset-env --save-dev
</code></pre></div><p>然后在项目的根目录下，创建一个 babel 的配置文件.babelrc，内容如下：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有了 babel-loader，可以使用 webpack 命令的--module-bind来指定对应的文件需要经过怎样的 Loader 处理，所以继续修改 npm scripts：</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;dev&quot;: &quot;webpack --mode development ./src/es/index.js --module-bind js=babel-loader&quot;,
    &quot;build&quot;: &quot;webpack --mode production ./src/es/index.js --module-bind js=babel-loader&quot;
}
</code></pre></div><p>添加完毕，执行npm run build，看下 dist/main.js的文件，就是转换后的 ES5 语法的打包结果了。</p> <p><img src="http://img.mukewang.com/5cd8d62f00016e7114440696.png" alt=""></p> <blockquote><p><em><strong>Tips：</strong></em>
下面介绍几个 webpack-cli 的小技巧：</p> <ol><li>当项目逐渐变大或者使用生产环境打包的时候，Webpack 的编译时间会变长，可以通过参数让编译的输出内容带有进度和颜色： webpack --progress --colors；</li> <li>Webpack 的配置比较复杂，很容出现错误，如果出问题，会打印一些简单的错误信息，我们还可以通过参数 --display-error-details 来打印错误详情：webpack --display-error-details；</li> <li>如果不想每次修改模块后都重新编译，那么可以启动监听模式，开启监听模式后，没有变化的模块会在编译后缓存到内存中，而不会每次都被重新编译，所以监听模式的整体速度是很快的：webpack --watch；</li> <li>webpack-cli 支持两个快捷选项：-d 和 -p ，分别代表一些常用的开发环境和生产环境的打包。</li></ol></blockquote> <h2 id="小结"><a href="#小结" aria-hidden="true" class="header-anchor">#</a> 小结</h2> <p>至此，我们已经学习并且演示了使用 webpack-cli 命令来完成 Webpack 的零配置打包，后面章节我们继续介绍 Webpack 的打包配置。webpack-cli 命令的选项比较多，详细可以通过 <a href="https://webpack.js.org/api/cli" target="_blank" rel="noopener noreferrer">webpack-cli 的文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>进行查阅，这里总结我们日常用的最多的几个选项（options）：</p> <blockquote><ul><li>–config：指定一个 Webpack 配置文件的路径；</li> <li>–mode：指定打包环境的 mode，取值为development和production，分别对应着开发环境和生产环境；</li> <li>–json：输mode出 Webpack 打包的结果，可以使用webpack --json &gt; stats.json方式将打包结果输出到指定的文件；</li> <li>–progress：显示 Webpack 打包进度；</li> <li>–watch, -w：watch 模式打包，监控文件变化之后重新开始打包；</li> <li>–color, --colors/–no-color, --no-colors：控制台输出的内容是否开启颜色；</li> <li>–hot：开启 Hot Module Replacement模式，后面会详细介绍；</li> <li>–profile：会详细的输出每个环节的用时（时间），方便排查打包速度瓶颈。</li></ul></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/14/2019, 7:37:16 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/0003.html" class="prev">03 Webpack 开发环境搭建</a></span> <span class="next"><a href="/0005.html">05 基础概念和常见配置项介绍（一）</a>→
    </span></p></div> </main></div><div class="global-ui"><SWUpdatePopup></SWUpdatePopup></div></div>
    <script src="/assets/js/app.92625234.js" defer></script><script src="/assets/js/2.38d85b4c.js" defer></script><script src="/assets/js/9.d271e8c5.js" defer></script>
  </body>
</html>
